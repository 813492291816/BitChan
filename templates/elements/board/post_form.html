{% set thread = None %}
{% if "current_thread" in board %}
    {% set thread = board["current_thread"] %}
{% endif %}

{% set chan = board['current_chan'] %}

<div>
	<form method="post" enctype="multipart/form-data" autocomplete="off" onsubmit="return checkForm(this);">
		<input type="hidden" name="thread_id" value="{{thread.thread_hash}}"/>
		<input type="hidden" name="board_id" value="{{board['current_chan'].address}}"/>
		<input type="hidden" name="submit" value="Post"/>
		<table class="form themed bold" style="table-layout: fixed; width: 600px;">
			<tbody>
				<tr>
					<td class="form themed bold">From</td>
					<td colspan="2">
					  {% include '/elements/board/form_post_from.html' %}
				    </td>
				</tr>
				<tr>
					<td class="form themed bold">Flag</td>
					<td colspan="2">
						{{form_post.nation(style="width: 100%")}}
				    </td>
				</tr>
				<tr>
					<td class="form themed bold">Subject</td>
					<td colspan="2">
						{% if not thread %}
							<input type="hidden" name="is_op" value="yes"/>
							<input class="form" style="width: 100%; box-sizing: border-box;" maxlength="64" name="subject" type="text" value="{% if "subject" in form_populate and form_populate["subject"] %}{{form_populate["subject"]}}{% endif %}"/>
						{% else %}
							<input type="hidden" name="is_op" value="no"/>
							<input type="hidden" name="op_md5_hash" value="{{thread.op_md5_hash}}"/>
							<span class="subject bold">{{thread.subject|safe}}</span>
						{% endif %}
					</td>
				</tr>
				<tr>
					<td class="form themed bold">Comment</td>
					<td colspan="2">
						{% include '/elements/board/form_post_comment.html' %}
					</td>
				</tr>
				<tr>
					<td class="form themed bold">Image/File</td>
					<td colspan="2"><input name="file" type="file"/>{% if "file" in form_populate and form_populate["file"] %}<br/><strong>PLEASE RESELECT FILE/IMAGE</strong>{% endif %}
				</tr>
				<tr>
					<td class="form themed bold">Image Spoiler</td>
					<td colspan="2"><input type="checkbox" id="image_spoiler" name="image_spoiler" value="y"{% if "image_spoiler" in form_populate and form_populate["image_spoiler"] %} checked{% endif %}/></td>
				</tr>
				<tr>
					<td class="form themed bold">Strip EXIF (JPG/PNG only)</td>
					<td colspan="2"><input type="checkbox" id="strip_exif" name="strip_exif" value="y"{% if "strip_exif" in form_populate and not form_populate["strip_exif"] %}{% else %} checked{% endif %}/></td>
				</tr>
			    <tr>
				    <td class="form themed bold">Upload</td>
					<td>
					  <select name="upload">
					    <option value="bitmessage"{% if "upload" in form_populate and form_populate["upload"] == "bitmessage" %} selected{% endif %}>Bitmessage (most secure, ~250KB)</option>
					  {% for each_server in config.UPLOAD_SERVERS_NAMES %}
					    <option value="{{each_server[0]}}"{% if "upload" in form_populate and form_populate["upload"] == each_server[0] %} selected{% endif %}>{{each_server[1]}}</option>
					  {% endfor %}
				      </select>
				    </td>
					<td>
						<input class="postbutton" type="submit" name="submit_post" value="Post"/>
					</td>
			    </tr>
				<tr>
					<td colspan="3">
						<div id="accordion-add-options" style="display: none">
							<h3>Additional Options</h3>
							<div>
								<table style="width: 100%">
									<tbody>
										<tr>
											<td class="form themed bold">Steg Comment<br/>(JPG/PNG only)</td>
											<td><textarea rows="7" maxlength="246250" class="form" style="width: 100%; box-sizing: border-box;" name="steg_message">{% if "steg_comment" in form_populate and form_populate["steg_comment"] %}{{form_populate["steg_comment"]}}{% endif %}</textarea></td>
										</tr>
										<tr>
											<td class="form themed bold">Steg Passphrase</td>
											<td><input class="form" style="width: 100%; box-sizing: border-box;" name="steg_passphrase" type="text" value="{% if "steg_passphrase" in form_populate and form_populate["steg_passphrase"] %}{{form_populate["steg_passphrase"]}}{% else %}{{config.PASSPHRASE_STEG}}{% endif %}"/></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</form>
</div>
