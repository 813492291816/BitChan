{% extends "layout.html" %}

{% block title %}HOME{% endblock %}

{% block head %}
    <style>
        .column {
          float: left;
          width: 32.3%;
          padding: 0 0.5%;
        }

        /* Remove extra left and right margins, due to padding in columns */
        .row {margin: 0 -5px;}

        /* Clear floats after the columns */
        .row:after {
          content: "";
          display: table;
          clear: both;
        }

        /* Style the counter cards */
        .card {
          box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
          padding: 16px;
          text-align: center;
          background-color: #f1f1f1;
        }

        /* Responsive columns - one column layout (vertical) on small screens */
        @media screen and (max-width: 600px) {
          .column {
            width: 100%;
            display: block;
            margin-bottom: 20px;
          }
        }

        .three-dots {
          text-align: center;
          padding: 0.2em 0 0.5em 0;
        }

        .three-dots span {
          width: 5px;
          height: 5px;
          border-radius: 50%;
          background: black;
          display: inline-block;
          margin: 0 3px;
        }
    </style>
{% endblock %}

{% block body %}
    {% include '/elements/banner.html' %}
    <br/>

    {% if status_msg["status_message"] %}
        {% include '/elements/status.html' %}
    {% endif %}

    <div class="intro bold">
        <p>
            <center><h1 class="title themed bold">Welcome to BitChan</h1></center>
            <br/>
            <center>BitChan is a decentralized anonymous image board built on top of <a target="_blank" href="https://bitmessage.org">BitMessage</a> with <a target="_blank" href="https://www.torproject.org">Tor</a> and <a target="_blank" href="https://gnupg.org">GnuGP</a>.</center>
            <br/>
        This is a beta release of BitChan. Some features are only partially implemented and there are likely to be bugs. Please report any issues or bugs you find with a <a href="/bug_report">Bug Report</a>. Also watch the official <a href="http://172.28.1.1/board/BM-2cVZdtgUe7uq7LbWx12W2btJybAphF3VxG/1">BitChan-Dev Board</a> for announcements, the <a href="http://172.28.1.1/list/BM-2cUYu7r41Bbnox4P8gEVtdnZGLnisgG7Yu">BitChan List</a> for other boards and lists that may appear for discussion and other purposes, and the <a href="https://www.github.com/813492291816/BitChan">BitChan GitHub page</a> for updates to the code.
        </p>
    </div>

    {% if newest_posts %}
    <div class="intro">
        {% for each_board in newest_posts %}
            {% if loop.index < 6 %}
        <div style="padding: {% if not loop.first %}1.5em{% else %}0{% endif %} 0 0.5em 0.5em">
            <a style="font-size: 1.2em;" href="/board/{{each_board.address}}/1">/{{chans_board_info[each_board.address]["label"]|safe}}/ - {{chans_board_info[each_board.address]["description"]|safe}}</a>
        </div>
        <div class="row">
                {% for each_thread in newest_posts[each_board]["threads"] %}

            <div class="column">
                    {% set op_post = newest_posts[each_board]["threads"][each_thread][0] %}

                <div class="card" style="font-size: 1.2em;
                {%- if not op_post.file_currently_downloading and
                      not op_post.file_do_not_download and
                      (op_post.file_decoded or (op_post.file_url and op_post.file_download_successful)) and
                      op_post.file_extension in config.FILE_EXTENSIONS_IMAGE -%}
                background-size: 100%; background-repeat: no-repeat; background-image: linear-gradient(rgba(255,255,255,0.2), rgba(255,255,255,0.2)), url({% if op_post.image_spoiler %}/static/spoiler.png{% else %}/files/thumb/{{op_post.message_id}}/{{op_post.file_filename|urlencode}}{% endif %});
                {%- endif -%}
                ">
                    <div style="font-weight: bold; background: rgba(240, 240, 240, 0.7); overflow-wrap: break-word;">
                        <a style="font-size: 1.4em;" href="/thread/{{each_board.address}}/{{each_thread.thread_hash}}">{{each_thread.subject|safe}}</a><br>
                    {% for each_message in newest_posts[each_board]["threads"][each_thread] %}
                        {% set msg_str = clean_html(each_message.message) %}
                        {% if not loop.first %}
                            (R):
                        {% endif %}
                        {% if msg_str|length > 30 %}
                            {{msg_str[:30]|safe}}...
                        {% elif msg_str %}
                            {{msg_str|safe}}
                        {% else %}
                            [No Text]
                        {% endif %}
                        {% if loop.first %}
                        <div class="three-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        {% elif not loop.last %}
                        <br/>
                        {% endif %}
                    {% endfor %}
                    </div>
                </div>
            </div>
                {% endfor %}
        </div>
            {% endif %}
        {% endfor %}
    </div>
    {% endif %}

    {% include '/elements/display_boards.html' %}
    {% include '/elements/display_lists.html' %}
    {% include '/elements/join_config.html' %}
    <div style="padding-top: 1em"></div>
{% endblock %}
